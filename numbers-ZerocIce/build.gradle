plugins {
    id 'java'
}

allprojects {
    repositories {
        mavenCentral()
        maven {
            url "https://repo.zeroc.com/nexus/content/repositories/releases"
        }
    }
}

subprojects {
    apply plugin: 'java'
    
    java {
        sourceCompatibility = JavaVersion.VERSION_11
        targetCompatibility = JavaVersion.VERSION_11
    }
    
    dependencies {
        implementation 'com.zeroc:ice:3.7.10'
        implementation 'com.zeroc:glacier2:3.7.10'
        implementation 'com.zeroc:icestorm:3.7.10'
        implementation 'com.zeroc:icelocatordiscovery:3.7.10'
        implementation 'com.zeroc:icepatch2:3.7.10'
    }
    
    compileJava {
        options.encoding = 'UTF-8'
    }
}

// Configuración específica para proyectos de aplicación
configure(subprojects.findAll { it.name in ['maestro', 'cliente', 'trabajador'] }) {
    apply plugin: 'application'
    
    dependencies {
        implementation project(':generated')
    }
    
    run {
        standardInput = System.in
    }
}